ext.adb = "$System.env.ANDROID_SDK/platform-tools/adb"
tasks.register('generateScreenshots') {
    doLast {
        def command = "${adb} shell am instrument -w -e testType screenshot com.fsck.k9.planck.ui.activities.test/com.fsck.k9.planck.ui.activities.test.CucumberTestCase"
        exec {
            commandLine command.split(' ')
        }
    }
}

task installDebugApp(dependsOn: 'installEnterpriseDebug')
task installTestDebugApp(dependsOn: 'installEnterpriseDebugAndroidTest')
task uninstallTestDebugApp(dependsOn: 'uninstallEnterpriseDebugAndroidTest')
generateScreenshots.dependsOn(installTestDebugApp)
installTestDebugApp.dependsOn(installDebugApp)
installDebugApp.dependsOn(uninstallTestDebugApp)
